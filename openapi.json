{"openapi":"3.1.0","info":{"title":"Review Classification API","description":"ML-powered review advertisement classification API","version":"0.1.0"},"paths":{"/health":{"get":{"tags":["health"],"summary":"Health Check","description":"Health check endpoint.\n\nReturns:\n    200: Service is healthy","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/api/reviews/classify":{"post":{"tags":["classification"],"summary":"Classify Review","description":"Classify a single review.\n\nArgs:\n    request: Classification request\n    db: Database session (optional, only needed if persist=True)\n\nReturns:\n    Classification result\n\nRaises:\n    422: Invalid input\n    503: Model not ready or DB unavailable","operationId":"classify_review_api_reviews_classify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassifyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ClassifyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/reviews/batch-classify":{"post":{"tags":["classification"],"summary":"Batch Classify Reviews","description":"Classify multiple reviews in batch.\n\nArgs:\n    request: Batch classification request (max 100 reviews)\n    db: Database session (optional, only needed if persist=True)\n\nReturns:\n    Batch classification results\n\nRaises:\n    422: Invalid input or too many reviews\n    503: Model not ready or DB unavailable","operationId":"batch_classify_reviews_api_reviews_batch_classify_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchClassifyRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchClassifyResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/reviews/feedback":{"post":{"tags":["feedback"],"summary":"Submit Feedback","description":"Submit user feedback for a review.\n\nHandles:\n- Helpful/not helpful votes\n- Ad reports\n- Not ad reports\n\nArgs:\n    request: Feedback request\n    db: Database session\n\nReturns:\n    Feedback response\n\nRaises:\n    404: Review not found\n    409: Duplicate feedback (user already submitted this type of feedback)\n    422: Invalid feedback type or vote value\n    503: Database unavailable","operationId":"submit_feedback_api_reviews_feedback_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FeedbackRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FeedbackResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/reviews/label":{"post":{"tags":["admin"],"summary":"Submit Admin Label","description":"Submit admin gold label for a review.\n\nAdmin labels are the ground truth used for model training.\n\nArgs:\n    request: Admin label request\n    db: Database session\n    admin_key: Verified admin API key\n\nReturns:\n    Admin label response\n\nRaises:\n    401: Invalid admin API key\n    404: Review not found\n    503: Database unavailable","operationId":"submit_admin_label_api_admin_reviews_label_post","parameters":[{"name":"X-Admin-Key","in":"header","required":true,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminLabelRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminLabelResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/model/train":{"post":{"tags":["admin"],"summary":"Trigger Model Training","description":"Trigger model training.\n\nTrains a new model using all available admin labels (gold labels).\nThe training is synchronous (MVP), but could be made async with Celery.\n\nArgs:\n    request: Training request\n    db: Database session\n    admin_key: Verified admin API key\n\nReturns:\n    Training response with job acceptance status\n\nRaises:\n    401: Invalid admin API key\n    409: Insufficient training data\n    422: Invalid training parameters\n    500: Training failed","operationId":"trigger_model_training_api_admin_model_train_post","parameters":[{"name":"X-Admin-Key","in":"header","required":true,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TrainModelRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TrainModelResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/model/info":{"get":{"tags":["model"],"summary":"Get Model Info","description":"Get information about the currently active model.\n\nReturns:\n    Model information including version, type, threshold, features, etc.\n\nRaises:\n    503: No model is currently active","operationId":"get_model_info_api_model_info_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelInfoResponse"}}}}}}}},"components":{"schemas":{"AdminLabelRequest":{"properties":{"reviewId":{"type":"string","title":"Reviewid","description":"Review ID to label"},"adminId":{"type":"string","title":"Adminid","description":"Admin user ID"},"label":{"type":"string","title":"Label","description":"Label: 'ad' or 'not_ad'"},"comment":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Comment","description":"Optional comment about the labeling decision"}},"type":"object","required":["reviewId","adminId","label"],"title":"AdminLabelRequest","description":"Request schema for admin labeling.\nPOST /api/admin/reviews/label"},"AdminLabelResponse":{"properties":{"requestId":{"type":"string","title":"Requestid","description":"Request ID for tracing"},"ok":{"type":"boolean","title":"Ok","description":"Whether label was successfully recorded"},"latestLabel":{"type":"string","title":"Latestlabel","description":"The label that was set"}},"type":"object","required":["requestId","ok","latestLabel"],"title":"AdminLabelResponse","description":"Response schema for admin labeling."},"BatchClassifyRequest":{"properties":{"reviews":{"items":{"$ref":"#/components/schemas/ReviewInput"},"type":"array","maxItems":100,"minItems":1,"title":"Reviews","description":"Reviews to classify (max 100)"},"options":{"anyOf":[{"$ref":"#/components/schemas/ClassifyOptions"},{"type":"null"}],"description":"Classification options"}},"type":"object","required":["reviews"],"title":"BatchClassifyRequest","description":"Request schema for batch review classification.\nPOST /api/reviews/batch-classify"},"BatchClassifyResponse":{"properties":{"requestId":{"type":"string","title":"Requestid","description":"Request ID for tracing"},"results":{"items":{"$ref":"#/components/schemas/BatchClassifyResultItem"},"type":"array","title":"Results","description":"Classification results"}},"type":"object","required":["requestId","results"],"title":"BatchClassifyResponse","description":"Response schema for batch review classification."},"BatchClassifyResultItem":{"properties":{"reviewId":{"type":"string","title":"Reviewid","description":"Review ID"},"isAdLike":{"type":"boolean","title":"Isadlike","description":"Whether review is ad-like"},"adScore":{"type":"number","title":"Adscore","description":"Ad probability score"},"threshold":{"type":"number","title":"Threshold","description":"Threshold used"},"modelVersion":{"type":"string","title":"Modelversion","description":"Model version"},"reasons":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Reasons","description":"Reason codes"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if classification failed"}},"type":"object","required":["reviewId","isAdLike","adScore","threshold","modelVersion"],"title":"BatchClassifyResultItem","description":"Individual result item in batch classification response."},"ClassifyOptions":{"properties":{"persist":{"type":"boolean","title":"Persist","description":"Whether to persist review and classification to database","default":true},"includeReasons":{"type":"boolean","title":"Includereasons","description":"Whether to include reason codes in response","default":true}},"type":"object","title":"ClassifyOptions","description":"Options for classification requests."},"ClassifyRequest":{"properties":{"review":{"$ref":"#/components/schemas/ReviewInput","description":"Review to classify"},"options":{"anyOf":[{"$ref":"#/components/schemas/ClassifyOptions"},{"type":"null"}],"description":"Classification options"}},"type":"object","required":["review"],"title":"ClassifyRequest","description":"Request schema for single review classification.\nPOST /api/reviews/classify"},"ClassifyResponse":{"properties":{"requestId":{"type":"string","title":"Requestid","description":"Request ID for tracing"},"reviewId":{"type":"string","title":"Reviewid","description":"Review ID (external or internal)"},"isAdLike":{"type":"boolean","title":"Isadlike","description":"Whether review is ad-like"},"adScore":{"type":"number","maximum":1.0,"minimum":0.0,"title":"Adscore","description":"Ad probability score"},"threshold":{"type":"number","title":"Threshold","description":"Threshold used for classification"},"modelVersion":{"type":"string","title":"Modelversion","description":"Model version used"},"reasons":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Reasons","description":"Reason codes explaining classification"}},"type":"object","required":["requestId","reviewId","isAdLike","adScore","threshold","modelVersion"],"title":"ClassifyResponse","description":"Response schema for single review classification."},"FeedbackRequest":{"properties":{"reviewId":{"type":"string","title":"Reviewid","description":"Review ID to provide feedback on"},"userId":{"type":"string","title":"Userid","description":"User ID providing feedback"},"feedbackType":{"type":"string","title":"Feedbacktype","description":"Type of feedback: 'helpful_vote', 'ad_report', 'not_ad_report'"},"vote":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Vote","description":"Vote value: 'helpful' or 'not_helpful'"}},"type":"object","required":["reviewId","userId","feedbackType"],"title":"FeedbackRequest","description":"Request schema for user feedback submission.\nPOST /api/reviews/feedback"},"FeedbackResponse":{"properties":{"requestId":{"type":"string","title":"Requestid","description":"Request ID for tracing"},"ok":{"type":"boolean","title":"Ok","description":"Whether feedback was successfully recorded"}},"type":"object","required":["requestId","ok"],"title":"FeedbackResponse","description":"Response schema for feedback submission."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status"}},"type":"object","required":["status"],"title":"HealthResponse","description":"Health check response."},"ModelInfoResponse":{"properties":{"requestId":{"type":"string","title":"Requestid","description":"Request ID for tracing"},"modelVersion":{"type":"string","title":"Modelversion","description":"Active model version"},"modelType":{"type":"string","title":"Modeltype","description":"Model type (e.g., 'tfidf_sgd')"},"threshold":{"type":"number","title":"Threshold","description":"Classification threshold"},"lastTrainedAt":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Lasttrainedat","description":"When the model was last trained"},"featuresUsed":{"items":{"type":"string"},"type":"array","title":"Featuresused","description":"Features used by the model"},"status":{"type":"string","title":"Status","description":"Model status"}},"type":"object","required":["requestId","modelVersion","modelType","threshold","featuresUsed","status"],"title":"ModelInfoResponse","description":"Response schema for model information.\nGET /api/model/info"},"ReviewInput":{"properties":{"_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Id","description":"External review ID"},"title":{"type":"string","maxLength":500,"minLength":1,"title":"Title","description":"Review title"},"content":{"type":"string","minLength":1,"title":"Content","description":"Review content"},"category":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category","description":"Product category"},"rating":{"anyOf":[{"type":"number","maximum":5.0,"minimum":0.0},{"type":"null"}],"title":"Rating","description":"Rating (0-5)"},"authorId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorid","description":"Author user ID"},"author":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Author","description":"Author display name"},"verifiedPurchase":{"type":"boolean","title":"Verifiedpurchase","description":"Whether purchase is verified","default":false},"helpfulVotes":{"type":"integer","minimum":0.0,"title":"Helpfulvotes","description":"Number of helpful votes","default":0},"notHelpfulVotes":{"type":"integer","minimum":0.0,"title":"Nothelpfulvotes","description":"Number of not helpful votes","default":0},"trustScore":{"type":"integer","maximum":100.0,"minimum":0.0,"title":"Trustscore","description":"Trust score (0-100)","default":50},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags","description":"Review tags"},"sourcePlatform":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sourceplatform","description":"Source platform (e.g., 'ReviewTrust', 'Naver')"},"isSponsored":{"type":"boolean","title":"Issponsored","description":"Whether review is sponsored","default":false}},"type":"object","required":["title","content"],"title":"ReviewInput","description":"Input schema for a review (from frontend or external platforms).\nMaps to the JSON structure from the API specification."},"TrainModelRequest":{"properties":{"adminId":{"type":"string","title":"Adminid","description":"Admin user ID requesting training"},"mode":{"type":"string","title":"Mode","description":"Training mode: 'full' or 'incremental'","default":"full"},"minNewLabels":{"type":"integer","minimum":1.0,"title":"Minnewlabels","description":"Minimum number of new labels required to proceed","default":20},"activateIfBetter":{"type":"boolean","title":"Activateifbetter","description":"Whether to activate model if it performs better","default":true}},"type":"object","required":["adminId"],"title":"TrainModelRequest","description":"Request schema for triggering model training.\nPOST /api/admin/model/train"},"TrainModelResponse":{"properties":{"requestId":{"type":"string","title":"Requestid","description":"Request ID for tracing"},"accepted":{"type":"boolean","title":"Accepted","description":"Whether training request was accepted"},"jobId":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Jobid","description":"Training job ID (if async)"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message","description":"Additional message or error details"}},"type":"object","required":["requestId","accepted"],"title":"TrainModelResponse","description":"Response schema for training trigger."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}